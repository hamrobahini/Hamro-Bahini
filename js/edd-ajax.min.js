var edd_scripts;function edd_load_gateway(e){jQuery(".edd-cart-ajax").show(),jQuery("#edd_purchase_form_wrap").html('<span class="edd-loading-ajax edd-loading"></span>');var d=document.getElementById("edd-gateway-"+e).getAttribute("data-"+e+"-nonce"),t=edd_scripts.ajaxurl;0<t.indexOf("?")?t+="&":t+="?",t=t+"payment-mode="+e,jQuery.post(t,{action:"edd_load_gateway",edd_payment_mode:e,nonce:d},(function(d){jQuery("#edd_purchase_form_wrap").html(d),jQuery(".edd-no-js").hide(),jQuery("body").trigger("edd_gateway_loaded",[e])}))}jQuery(document).ready((function(e){var d,t;e(".edd-no-js").hide(),e("a.edd-add-to-cart").addClass("edd-has-js"),e(document.body).on("click.eddRemoveFromCart",".edd-remove-from-cart",(function(d){var t=(r=e(this)).data("cart-item"),a=r.data("action"),o=r.data("download-id"),r=r.data("nonce");return e.ajax({type:"POST",data:{action:a,cart_item:t,nonce:r},dataType:"json",url:edd_scripts.ajaxurl,xhrFields:{withCredentials:!0},success:function(d){if(d.removed){if(parseInt(edd_scripts.position_in_cart,10)===parseInt(t,10)||edd_scripts.has_purchase_links)return window.location=window.location,!1;e(".edd-cart").each((function(){e(this).find("[data-cart-item='"+t+"']").parent().remove()})),e(".edd-cart").each((function(){var d=0;e(this).find("[data-cart-item]").each((function(){e(this).attr("data-cart-item",d),d+=1}))})),e("[id^=edd_purchase_"+o+"]").length&&(e("[id^=edd_purchase_"+o+"] .edd_go_to_checkout").hide(),e("[id^=edd_purchase_"+o+"] a.edd-add-to-cart").show().removeAttr("data-edd-loading"),"1"==edd_scripts.quantities_enabled&&e("[id^=edd_purchase_"+o+"] .edd_download_quantity_wrapper").show()),e("span.edd-cart-quantity").text(d.cart_quantity),e(document.body).trigger("edd_quantity_updated",[d.cart_quantity]),edd_scripts.taxes_enabled&&(e(".cart_item.edd_subtotal span").html(d.subtotal),e(".cart_item.edd_cart_tax span").html(d.tax)),e(".cart_item.edd_total span").html(d.total),0==d.cart_quantity&&(e(".cart_item.edd_subtotal,.edd-cart-number-of-items,.cart_item.edd_checkout,.cart_item.edd_cart_tax,.cart_item.edd_total").hide(),e(".edd-cart").each((function(){var d=e(this).parent();d.length&&(d.addClass("cart-empty"),d.removeClass("cart-not-empty")),e(this).append('<li class="cart_item empty">'+edd_scripts.empty_cart_message+"</li>")}))),e(document.body).trigger("edd_cart_item_removed",[d])}}}).fail((function(e){window.console&&window.console.log&&console.log(e)})).done((function(e){})),!1})),e(document.body).on("click.eddAddToCart",".edd-add-to-cart",(function(d){d.preventDefault();var t=e(this),a=t.closest("form");t.prop("disabled",!0),t.find(".edd-loading");var o=t.closest("div");t.attr("data-edd-loading","");a=t.parents("form").last();var r=t.data("download-id"),i=t.data("variable-price"),n=t.data("price-mode"),c=t.data("nonce"),s=[],_=!0;if("yes"==i)if(0<a.find(".edd_price_option_"+r+'[type="hidden"]').length)s[0]=e(".edd_price_option_"+r,a).val(),a.find(".edd-submit").data("price")&&0<a.find(".edd-submit").data("price")&&(_=!1);else{if(!a.find(".edd_price_option_"+r+":checked",a).length)return t.removeAttr("data-edd-loading"),alert(edd_scripts.select_option),d.stopPropagation(),t.prop("disabled",!1),!1;a.find(".edd_price_option_"+r+":checked",a).each((function(d){s[d]=e(this).val(),!0!==_||(d=e(this).data("price"))&&0<d&&(_=!1)}))}else s[0]=r,t.data("price")&&0<t.data("price")&&(_=!1);return _&&a.find(".edd_action_input").val("add_to_cart"),"straight_to_gateway"==a.find(".edd_action_input").val()?(a.submit(),!0):(c={action:t.data("action"),download_id:r,price_ids:s,post_data:e(a).serialize(),nonce:c,timestamp:t.data("timestamp"),token:t.data("token")},e.ajax({type:"POST",data:c,dataType:"json",url:edd_scripts.ajaxurl,xhrFields:{withCredentials:!0},success:function(d){var c="1"==edd_scripts.redirect_to_checkout,s="1"==a.find("#edd_redirect_to_checkout").val();c&&s||!c&&s?window.location=edd_scripts.checkout_page:("1"===edd_scripts.taxes_enabled&&(e(".cart_item.edd_subtotal").show(),e(".cart_item.edd_cart_tax").show()),e(".cart_item.edd_total").show(),e(".cart_item.edd_checkout").show(),e(".cart_item.empty").length&&e(".cart_item.empty").hide(),e(".widget_edd_cart_widget .edd-cart").each((function(t){var a=e(this).find(".edd-cart-meta:first");e(d.cart_item).insertBefore(a),(a=e(this).parent()).length&&(a.addClass("cart-not-empty"),a.removeClass("cart-empty"))})),"1"===edd_scripts.taxes_enabled&&(e(".edd-cart-meta.edd_subtotal span").html(d.subtotal),e(".edd-cart-meta.edd_cart_tax span").html(d.tax)),e(".edd-cart-meta.edd_total span").html(d.total),e(".edd-cart-item-title",d.cart_item).length,e("span.edd-cart-quantity").each((function(){e(this).text(d.cart_quantity),e(document.body).trigger("edd_quantity_updated",[d.cart_quantity])})),"none"==e(".edd-cart-number-of-items").css("display")&&e(".edd-cart-number-of-items").show("slow"),"no"!=i&&"multi"==n||(e("a.edd-add-to-cart",o).toggle(),e(".edd_go_to_checkout",o).css("display","inline-block")),"multi"==n&&t.removeAttr("data-edd-loading"),!e(".edd_download_purchase_form").length||"no"!=i&&a.find(".edd_price_option_"+r).is("input:hidden")||(s=e('.edd_download_purchase_form *[data-download-id="'+r+'"]').parents("form"),e("a.edd-add-to-cart",s).hide(),"multi"!=n&&s.find(".edd_download_quantity_wrapper").slideUp(),e(".edd_go_to_checkout",s).show().removeAttr("data-edd-loading")),"incart"!=d&&(e(".edd-cart-added-alert",o).fadeIn(),setTimeout((function(){e(".edd-cart-added-alert",o).fadeOut()}),3e3)),t.prop("disabled",!1),e(document.body).trigger("edd_cart_item_added",[d]))}}).fail((function(e){window.console&&window.console.log&&console.log(e)})).done((function(e){})),!1)})),e("#edd_checkout_form_wrap").on("click",".edd_checkout_register_login",(function(){var d={action:(d=e(this)).data("action"),nonce:d.data("nonce")};return e(".edd-cart-ajax").show(),e.post(edd_scripts.ajaxurl,d,(function(d){e("#edd_checkout_login_register").html(edd_scripts.loading),e("#edd_checkout_login_register").html(d),e(".edd-cart-ajax").hide()})),!1})),e(document).on("click","#edd_purchase_form #edd_login_fields input[type=submit]",(function(d){d.preventDefault();var t=e(this).val();e(this).val(edd_global_vars.purchase_loading),e(this).after('<span class="edd-loading-ajax edd-loading"></span>'),d={action:"edd_process_checkout_login",edd_ajax:1,edd_user_login:e("#edd_login_fields #edd_user_login").val(),edd_user_pass:e("#edd_login_fields #edd_user_pass").val(),edd_login_nonce:e("#edd_login_nonce").val()},e.post(edd_global_vars.ajaxurl,d,(function(d){"success"==e.trim(d)?(e(".edd_errors").remove(),window.location=edd_scripts.checkout_page):(e("#edd_login_fields input[type=submit]").val(t),e(".edd-loading-ajax").remove(),e(".edd_errors").remove(),e("#edd-user-login-submit").before(d))}))})),e(document).on("change","select#edd-gateway, input.edd-gateway",(function(d){var t=e("#edd-gateway option:selected, input.edd-gateway:checked").val();return"0"==t||edd_load_gateway(t),!1})),"1"==edd_scripts.is_checkout&&(t=d=!1,e("select#edd-gateway, input.edd-gateway").length&&(d=e("meta[name='edd-chosen-gateway']").attr("content"),t=!0),d=d||edd_scripts.default_gateway,t?setTimeout((function(){edd_load_gateway(d)}),200):e("body").trigger("edd_gateway_loaded",[d])),e(document).on("click","#edd_purchase_form #edd_purchase_submit [type=submit]",(function(d){var t,a=document.getElementById("edd_purchase_form");"function"==typeof a.checkValidity&&!1===a.checkValidity()||(d.preventDefault(),t=e(this).val(),e(this).attr("data-original-value",t),e(this).val(edd_global_vars.purchase_loading),e(this).prop("disabled",!0),e(this).after('<span class="edd-loading-ajax edd-loading"></span>'),e.post(edd_global_vars.ajaxurl,e("#edd_purchase_form").serialize()+"&action=edd_process_checkout&edd_ajax=true",(function(d){"success"==e.trim(d)?(e(".edd_errors").remove(),e(".edd-error").hide(),e(a).submit()):(e("#edd-purchase-button").val(t),e(".edd-loading-ajax").remove(),e(".edd_errors").remove(),e(".edd-error").hide(),e(edd_global_vars.checkout_error_anchor).before(d),e("#edd-purchase-button").prop("disabled",!1),e(document.body).trigger("edd_checkout_error",[d]))})))})),e(document.body).on("change","#edd_cc_address input.card_state, #edd_cc_address select, #edd_address_country",(function(){var d,t=e(this),a="undefined"!=typeof edd_global_vars,o="card_state";"edd_address_country"==e(this).attr("id")&&(o="edd_address_state");var r=document.getElementById(o);return"card_state"!=t.attr("id")&&null!=r?(r=e(this).data("nonce"),r={action:"edd_get_shop_states",country:t.val(),field_name:o,nonce:r},e.ajax({type:"POST",data:r,url:edd_scripts.ajaxurl,xhrFields:{withCredentials:!0},success:function(r){d=a?e("#edd_purchase_form"):t.closest("form");var i,n='input[name="card_state"], select[name="card_state"], input[name="edd_address_state"], select[name="edd_address_state"]';"nostates"==e.trim(r)?(i='<input type="text" id='+o+' name="card_state" class="card-state edd-input required" value=""/>',d.find(n).replaceWith(i)):d.find(n).replaceWith(r),a&&e(document.body).trigger("edd_cart_billing_address_updated",[r])}}).fail((function(e){window.console&&window.console.log&&console.log(e)})).done((function(e){a&&recalculate_taxes()}))):a&&recalculate_taxes(),!1})),e(document.body).on("change","#edd_cc_address input[name=card_zip]",(function(){"undefined"!=typeof edd_global_vars&&recalculate_taxes()}))}));